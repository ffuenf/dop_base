# Generated by Chef
# Local modifications will be overwritten.

alias cd..='cd ..'
alias ..='cd ..'
alias ls='ls --color=auto -lah'
alias dir='ls --color=auto -lah --format=vertical'
alias rm='rm -i'
alias du='du -shx'

function set_prompt {
  local BLACK="\[\033[0;30m\]"
  local BLUE="\[\033[0;34m\]"
  local GREEN="\[\033[0;32m\]"
  local CYAN="\[\033[0;36m\]"
  local RED="\[\033[0;31m\]"
  local PURPLE="\[\033[0;35m\]"
  local BROWN="\[\033[0;33m\]"
  local LIGHT_GRAY="\[\033[0;37m\]"
  local DARK_GRAY="\[\033[1;30m\]"
  local LIGHT_BLUE="\[\033[1;34m\]"
  local LIGHT_GREEN="\[\033[1;32m\]"
  local LIGHT_CYAN="\[\033[1;36m\]"
  local LIGHT_RED="\[\033[1;31m\]"
  local LIGHT_PURPLE="\[\033[1;35m\]"
  local YELLOW="\[\033[1;33m\]"
  local WHITE="\[\033[1;37m\]"
  local NO_COLOUR="\[\033[0m\]"
  
  if [ "$HOSTNAME" = "<%= node['dop_base']['hosts']['hostname'] %>" ]; then
    local HOST_COLOUR=$LIGHT_RED
  fi
  
  local load=$(uptime | sed -e 's/^.*: \([0-9.]\+\), \([0-9.]\+\), \([0-9.]\+\).*$/\3/')
  local load_int=$(echo $load | sed -e 's/^\([0-9]\+\).*/\1/')
  
  if [ $load_int -lt 2 ]; then
    loadc="$LIGHT_GREEN$load$NO_COLOUR"
  elif [ $load_int -lt 4 ]; then
    loadc="$YELLOW$load$NO_COLOUR"
  else
    loadc="$LIGHT_RED$load$NO_COLOUR"
  fi
  
  local user="$WHITE[$LIGHT_RED\u$WHITE@$HOST_COLOUR"<%= node['dop_base']['hosts']['hostname'] %>"$WHITE]"
  PS1="${user}\
  $LIGHT_CYAN[<%= node['dop_base']['location'] %>]\
  $WHITE[$YELLOW`date '+%X'`$WHITE]$NO_COLOUR\
  $WHITE[$NO_COLOUR$loadc$WHITE]$NO_COLOUR\
  $mnt_tmp\$NO_COLOUR\n\
  $WHITE($YELLOW\w$WHITE) \\$ $NO_COLOUR"
}

export PROMPT_COMMAND=set_prompt